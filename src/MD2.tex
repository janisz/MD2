\documentclass[12pt,a4paper]{article}

\usepackage[utf8]{inputenc}
\usepackage[T1]{fontenc}
\usepackage[a4paper]{geometry}
\usepackage{fullpage}
\usepackage{pdflscape}
\usepackage{float}

\usepackage{amsthm}
\usepackage{amsfonts}
\usepackage{amsmath} 		%pakiet potrzebny do \eqref
\usepackage{amssymb} 		%pakiet potrzebny do \blacksquare i \mathbb{}

\usepackage[pdfauthor={Janisz},%
	pdftitle={MD2},%
	pagebackref=true,%
	pdftex]{hyperref}
\hypersetup{colorlinks=true}%kolorowe linki

\usepackage{graphicx}		%do obrazków
\usepackage[polish]{babel}	%babel musi być po ams inaczej generuje błedy https://groups.google.com/d/msg/pl.comp.dtp.tex.gust/AfdVxQVu_DI/Fego6Pxz3HMJ

%-----------------------DEFINICJE------------------------------------------
\newtheorem{lemat}{Lemat}
\newtheorem{tw}{Twierdzenie}
\newtheorem{przyklad}{Przykład}
\theoremstyle{definition}
\newtheorem{df}{Definicja}
\newtheorem{wniosek}{Wniosek}
\newtheorem{problem}{Problem}
\newtheorem{algo}{Algorytm}
\newcommand{\egz}{\marginpar{\color{red} EGZAMIN}} %gneruje ostrzeżenia?
%-------------------------------------------------------------------------

\title{ Matematyka Dyskretna 2}
\author{Tomasz Janiszewski}
\date{\today}

\begin{document}

\maketitle

\tableofcontents

\DeclareGraphicsExtensions{.pdf,.png,.jpg}
\begin{center}
\leavevmode
\includegraphics[width=1 in]{../img/by-sa.png}
\end{center}
\label{fig:cc}
%insert a link to the licence and its description below
\scriptsize{Ten utwór jest dostępny na licencji  \href{http://creativecommons.org/licenses/by-sa/3.0/pl/}{Creative Commons Uznanie autorstwa-Na tych samych warunkach 3.0 Polska.}}

\pagebreak
%---------------%
%1. Wyklad		%
%	4.10.2011	%
%---------------%
\section{Ścieżka i cykl \href{http://pl.wikipedia.org/wiki/Leonhard_Euler}{Eulera}}
%TODO Dodać opis problemu
\begin{df}
Ścieżką Eulera w grafie $G$ nazywamy ścieżkę $v_0e_1v_1e_2 \dots e_nv_n$ taką że każda krawędź występuje na niej tylko raz
\end{df}
\begin{df}[Obwód Eulera]~\\
Jeżeli w danej $v_0 = v_n$ to ścieżkę nazywamy ścieżką zamkniętą lub obwodem Eulera
\end{df}
\begin{df}[Cykl Eulera]~\\
Jeżeli wierzchołki  w obwodem Eulera się nie powtarzają to taki obwód nazywamy cyklem Eulera.
\end{df}

\begin{lemat}\label{lemat:1}
Jeżeli $G$ jest grafem takim że $\delta (G) \geqslant 2$ to $G$ posiada cykl
\begin{proof}
Rozważmy najdłuższą drogę (wierzchołki się nie powtarzają) $v_0e_1v_1 \dots e_kv_k$ oraz niech $\deg v_0 \geqslant \delta(G) \geqslant 2$. Niech sąsiad $v_0 \neq v_1$ nazywa się $a$. $a \not\in \{v_2, \dots, v_k\}$ bo gdyby należał do ścieżki to $av_0v_1 \dots v_k$ byłaby dłuższa niż $v_0 \dots v_k$ wbrew założeniu. Czyli $a\in \{v_2, \dots, v_k\}$ czyli $a = v_i$.\\ Mamy cykl! 
%TODO Dodać ilustrację
\end{proof}
\end{lemat}

\begin{tw}[Eulera]\label{tw:Eulera}~\\
Graf spójny ma obwód Eulera $\Leftrightarrow$ wszystkie wierzchołki mają parzyste stopnie
\begin{proof}
$\Rightarrow$\\
Przemierzając obwód Eulera wchodzimy i wychodzimy do każdego wierzchołka tyle samo razy za każdym razem inną krawędzią. Ponieważ każda krawędź leży w obwodzie Eulera to każdy wierzchołek jest parzystego stopnia
\end{proof}
\begin{proof}
$\Leftarrow$ \emph{nie wprost}\\
Przypuśćmy że twierdzenie nie jest prawdziwe. Ze wszystkich kontrprzykładów weźmy ten który ma najmniej krawędzi, nazwijmy go $G$. To znaczy $G$ jest spójny, wszystkie wierzchołki ma parzystego stopnia a nie ma obwodu Eulera. To znaczy że $|G| > 1$\footnote{graf o jednym wierzchołku ma obwód Eulera} oraz żaden wierzchołek nie jest stopnia 0 lub 1, każdy jest co stopnia co najmniej 2. Czyli z lematu \ref{lemat:1} $G$ ma cykl, a cykl $\subset$ obwód.
Weźmy najdłuższy obwód w $G$ i nazwijmy $C$. $E(C) \neq E(G)$ bo w przeciwnym przypadku $C$ byłby obwodem Eulera w $G$.
\\Rozważmy $G-E(C)$ zawiera jakieś krawędzie. Zastanówmy się nad parzystością stopni $G-E(C)$. W $G-E(C)$ każdy wierzchołek jest parzystego stopnia. czyli każda składowa o nieparzystym zbiorze krawędzi\footnote{$G-E(C)$ nie musi być grafem spójnym} $G-E(C)$ nie jest kontrprzykładem ($G$ był najmniejszy) zatem ma obwód Eulera $C'$.\\
Istnieje wierzchołek $x\in V(C) \cap V(C')$ bo w przeciwnym przypadku $G$ nie byłby spójny.\\
Obwód $xCxC'x$ jest dłuższy niż $C$, a $G$ maił być najdłuższy (o większej liczbie krawędzi). Sprzeczność z definicją $C$.
\end{proof}
%TODO Sprawdzić ten dowód
\end{tw}

\subsection{Algorytm znajdowania obwodu Eulera w grafie}
\begin{lemat}\label{lemat:2}
Jeżeli graf $G$ jest spójny i ma wszystkie wierzchołki parzystego stopnia, to nie ma mostu
\begin{proof}
Przypuśćmy przeciwnie.\\
Niech $e = xy$ będzie mostem w $G$. $G-e$ ma dokładnie dwie składowe $G_x, G_y$. W $G_x$ wszystkie wierzchołki oprócz $X$ są parzystego stopnia. Sprzeczność z zasadą, że suma stopni w grafie jest parzysta (suma stopni jest dwa razy większa od liczby krawędzi)
\end{proof}
\end{lemat}

\begin{algo}[Algorytm Fleury'ego]
\begin{enumerate}
\item Wybieram wierzchołek startowy $v_0, ~ w = v_0$
\item Załóżmy, że skonstruowaliśmy już ścieżkę $w=v_0e_1v_1 \dots e_iv_i$ wybieram krawędź $e_{i+1}$ taką że
	\begin{enumerate}
		\item $e_{i+1} \in E(G) \smallsetminus \{e_1, \dots, e_i\}$
		\item $e_{i+1}$ jest incydentna z $v_i$
		\item o ile to możliwe $e_{i+1}$ nie jest mostem w $G_i = G - \{e_1, \dots, e_i\}$\label{point:1}
	\end{enumerate}
\item STOP kiedy krok 2 nie może się wykonać
%TODO Dodać przykład
\end{enumerate}
\end{algo}

\begin{tw}
Jeżeli $G$ ma obwód Eulera to algorytm Fleury'ego znajdzie taki obwód
\begin{proof}
$w_n = v_0e_1v_1 \dots e_nv_n$ ścieżka skonstruowana przez algorytm Fleury'ego. $w_n$ nie zawiera żadnej krawędzi więcej niż raz. W momencie zatrzymania się algorytmu stopnień $v_n$ w grafie $G-\{e_1, \dots, e_n\}$ jest równy $0$.\\
Jeżeli $v_n = v_0$ to ma nieparzysty stopień, a ma mieć $0$. Czyli $v_n = v_0$\footnote{gdyby tak nie było oznaczałoby to  że wyszliśmy o jeden raz więcej niż weszliśmy} Czyli $\deg_{G-\{e_1, \dots, e_n\}}v_n$ jest nieparzysty. Sprzeczność bo zero jest parzyste.\\
Wystarczy pokazać, że $E(w_n)=E(G)$.\\
Przypuśćmy, że nie jest. $G_n = G-E(w_n)$ ma niepusty zbiór krawędzi.
\\ Niech $S$ - zbiór wierzchołków dodatniego stopnia w $G_n$.
\\ Niech $\overline{S}$ - zbiór wszystkich wierzchołków zerowego stopnia. $\overline{S}=V(G)-S$
\\ Niech $m$ będzie największym indeksem takim że $V_m \in S$ a $V_{m+1} = e_{m+1}$
%TODO Dodać obrazek
\\ Czyli krawędź $e_{m+1}$ jest mostem w $G_m = G - \{e_1, \dots, e_m\}$ bo jest jedyną krawędzią między $S$ i $\overline{S}$. Z punkty \ref{point:1} wynika że wszystkie krawędzie w $G_m$ o końcu $v_m$ są mostami.
\\ Rozważmy $G_m[S]$, w którym wszystkie wierzchołki są parzystego stopnia a $v_m$ jest końcem mostu. Sprzeczność z lematem \ref{lemat:2}.
%TODO Porównać z http://pl.wikipedia.org/wiki/Algorytm_Fleury%27ego#Dow.C3.B3d_poprawno.C5.9Bci_algorytmu
\end{proof}
\end{tw}

%---------------%
%2. Wyklad		%
%	11.10.2011	%
%---------------%
\subsection{Wniosek z twierdzenia Eulera}
\begin{tw}
Spójny multigraf $G$ ma ścieżkę Eulera\footnote{nie musi się kończyć tam gdzie się zaczęła} $\Leftrightarrow~ G$ ma co najwyżej 2 wierzchołki nieparzystego stopnia.
\begin{proof}
$\Rightarrow$\\
Idąc ścieżką Eulera wchodzimy do każdego wierzchołka być może z wyjątkiem pierwszego i ostatniego tyle samo razy co wychodzimy, zatem każdy wierzchołek (może z wyjątkiem pierwszego i ostatniego) ma parzysty stopień.
\end{proof} 
\begin{proof}
$\Leftarrow$
	\begin{enumerate}
		\item Jeśli jest 0 wierzchołków nieparzystego stopnia to z twierdzenia \hyperref[tw:Eulera]{Eulera} istnieje obwód Eulera, który jest ścieżką.
		\item Nie może być dokładnie jeden wierzchołek nieparzystego stopnia, bo suma stopni musi być parzysta.
		\item Jeżeli są 2 takie wierzchołki połączmy je krawędzią. Otrzymujemy multigraf o wszystkich wierzchołkach parzystego stopnia. Z twierdzenia \hyperref[tw:Eulera]{Eulera} ma on obwód Eulera. Usuwając uprzednio dodaną krawędź otrzymujemy ścieżkę  Eulera.
	\end{enumerate}
\end{proof}
\end{tw}

\subsection{Problem chińskiego listonosza}
Listonosz musi dostarczyć listy do adresatów, czyli przejść przez każdą ulicę w mieście. Jak ma przejść aby pokonać najkrótszą trasę?\\
%TODO Dodać rysunek
Dane: Spójny multigraf $G$, funkcja wag krawędzi (długość ulic) $w : E(G) \to [0,\infty)$\\
Problem: Znaleźć trasę, czyli ciąg wierzchołków taki że:
\begin{enumerate}
	\item każda krawędź występuje w ciągu
	\item $\forall i \quad e_i = v_{i-1}v_i$
	\item $\sum\limits_{i=1}^{p} w(e_i)$ była minimalna 
\end{enumerate}
Szkic rozwiązania
\begin{enumerate}
	\item Połączy krawędziami wierzchołki nieparzystych stopni po dwa tak aby suma wag u nowych krawędzi była jak najmniejsza\footnote{algorytm jest skomplikowany}
	\item Znajdźmy obwód Eulera w nowym multigrafie
\end{enumerate}
%TODO Poprawić formatowanie problemów

\section{Cykle i drogi \href{http://pl.wikipedia.org/wiki/William_Rowan_Hamilton}{Hamiltona}}

\begin{df}[Droga Hamiltona]~\\
Drogę która zawiera wszystkie wierzchołki grafu $G$ nazywamy drogą Hamiltona
\end{df}

\begin{df}[Cykl Hamiltona]~\\
Cykl który zawiera wszystkie wierzchołki grafu $G$ nazywamy cyklem Hamiltona
\end{df}


%TODO Dodać przykłady

\begin{tw}
Jeżeli $G$ ma cykl Hamiltona to dla każdego $S\subset V(G) \quad \omega(G-S) \leqslant |S|$
\begin{proof}
Niech $C$ - cykl Hamiltona w $G$. Zauważmy, że $\omega(C-S) \leqslant |S|$ \\
$\omega(G-S) \leqslant \omega(C-S)$
\end{proof}
%TODO Dodać przykłady (szczególnie graf Petersena)
\end{tw}

\begin{tw}[\href{http://pl.wikipedia.org/wiki/Gabriel_Andrew_Dirac}{Diraca} (1952)]\egz
Jeżeli $G$ jest grafem takim że $G\geqslant 3, ~~ \delta(G)\geqslant \frac{|G|}{2}$ to $G$ ma cykl Hamiltona
\begin{proof}\emph{nie wprost}\\
Niech $G$ będzie kontrprzykładem do twierdzenia o maksymalnym zbiorze krawędzi, czyli grafem takim że ma co najmniej 3 wierzchołki $|G|\geqslant 3, ~~ \delta(G) \geqslant \frac{|G|}{2}$ nie ma cyklu Hamiltona i dodanie dowolnej krawędzi do $G$ powoduje powstanie cyklu Hamiltona\footnote{dodajemy tak długo jak się da}. Czyli graf $G$ nie jest grafem pełnym bo graf pełny zawiera cykl Hamiltona.\\
W $G$ istnieją wierzchołki $u$ i $v$ takie że $uv\not\in E(G)$\\
Z maksymalności $G$ wynika żę $u$ i $v$ są połączone drogą Hamiltona \footnote{bo $G+uv$ ma cykl Hamiltona to $G=(G+uv)-uv$ ma drogę Hamiltona} $u = v_0,v_1,\dots, v_n = v$ - droga\\
Zdefiniujmy dwa zbiory:
	\begin{enumerate}
		\item $T := \{ v_i: \quad v_iv\in E(G)\}$
		\item $S := \{ v_i: \quad uv_{i+1} \in E(G)\}$
	\end{enumerate}
%TODO Dodać rysunek
\begin{math}
|S| = \deg u \geqslant \frac{|G|}{2}\\
|T| = \deg v \geqslant \frac{|G|}{2}\\
v \not\in S \cup T \Rightarrow |S \cup T| \leqslant |G| -1\\
|G|-1 \geqslant |S \cup T| = \underbrace{\underbrace{|S|}_{\geqslant\frac{|G|}{2}} + \underbrace{|T|}_{\geqslant\frac{|G|}{2}}}_{\geqslant |G|} - |S \cap T| \Rightarrow |S\cap T| \geqslant 1 \Rightarrow S \cap T \neq \emptyset \\
\exists v_i ~:~ v_i \in S \cap T 
\end{math}
Sprzeczność istnieje cykl Hamiltona $v_1\dots v_iv_n\dots v_{i+1}v_1$
\end{proof}
\end{tw}

\subsection{Problem Komiwojażera}
Dane: Sieć $S = (G, w)\quad w~:~E(G)\to [0, \infty)$\\
Szukane: cykl Hamiltona o najmniejszej sumie wag krawędzi
\begin{wniosek}
Problem istnienia cyklu Hamiltona sprowadza się do problemu Komiwojażera\\
Dane: Czy $G$ ma cykl Hamiltona?
Rozwiązanie: Definiujemy $G' = K_{|G|}$\\
$w(e) = \left\lbrace
	\begin{array}{l l}
		1 & e\in E(G)\\
		2 & e\not\in E(G)
	\end{array}\right.
$
$G$ ma cykl Hamiltona $\Leftrightarrow$ istnieje rozwiązanie problemu komiwojażera dla $G'$ w wadze równej $|G|$
\end{wniosek}

%---------------%
%2. Wyklad		%
%	18.10.2011	%
%---------------%
\begin{algo}[Procedura $DFS$ - przeszukiwania drzewa w głąb]~\\
$T$ - drzewo skierowane od wierzchołka $v$\\
$v$ - wierzchołek
\begin{enumerate}
	\item Wypisz v
	\item Jeżeli $v1, \dots, v_p$ są nnastępnikami $v$ w $T$ to wykonaj $DFS(T, v_i)$ dla $i = 1, \dots, p$
\end{enumerate}
%TODO Dodać przykład
\end{algo}

\begin{algo}[APK (Aproksymacyjne rozwiązanie problemu komiwojażera)]~\\\label{algo:apk}
Algorytm znajduje przybliżone rozwiązanie problemu komiwojażera
\begin{enumerate}
	\item Wybierz wierzchołek startowy
	\item Skonstruuj minimalne drzewo rozpinające $T$ grafu $G$
	\item Wykonaj procedurę $DFS(T, v)$
\end{enumerate}
%TODO Dodać przykład
\end{algo}

\begin{tw}\egz
Algorytm \hyperref[algo:apk]{APK} konstruuje cykl Hamiltona o co najwyżej 2-krotnie większej sumie wag krawędzi w porównaniu z optymalnym o ile jest spełniony warunek trójkąta\footnote{$\forall x,y,z \quad w(x,y) + w(y,z) \geqslant w(x,z)$}
\begin{proof}~\\
$\begin{array}{l l}
T & \text{drzewo rozpinające skonstruowane w algorytmie}\\
H^* & \text{optymalny cykl Hamiltona}\\
H & \text{cykl Hamiltona skonstruowany przez APK}
\end{array}$\\
Weźmy $e\in E(H^*)$. $H^*\smallsetminus e$ to ścieżka rozpinająca, czyli drzewo rozpinające.
$$ \frac 12w(H) \leqslant w(T) \leqslant w(H^*\smallsetminus e) \leqslant w(H^*) $$
Procedura $DFS$ przechodzi przez każdą krawędź dwa razy. Gdy komiwojażer przechodził po $T$ to w sumie przeszedł by drogę długości $2w(T)$. Pomijając odwiedzone wcześniej wierzchołki nie zwiększymy sumy wag krawędzi dzięki nierówności trójkąta.
$$ w(H) \leqslant 2w(T) \leqslant 2w(H^*) $$
\end{proof}
\end{tw}

\subsection{Grafy dwudzielne}
\begin{df}
Graf $G=G(V, E)$ nazywamy grafem dwudzielnym, jeśli istnieją zbiory $X, Y$ takie że $X \cup Y = V$, $X \cap Y = \emptyset$ i $\forall e\in E ~~ |e\cap X| = 1$
\end{df}

\begin{df}
Graf dwudzielny $G$ nazywamy dwudzielnym pełnym jeżeli $\forall x\in X ~\forall y\in Y ~~ xy\in E$. Jeżeli $|Y| = m$, $|X| = n$ to $G$ nazywamy $K_{n,m}$
\end{df}

\begin{tw}\egz
Graf $G$ jest dwudzielny $\Leftrightarrow$ $G$ nie zawiera nieparzystych cykli\footnote{cykli o nieparzystej długości}
\begin{proof}$\Rightarrow$
$G$ jest dwudzielny. Przypuśćmy że w $G$ jest cykl nieparzystej długości $C ~:~ x_1,x_2,\dots, x_{2k+1}$. Bez straty ogólności zakładamy, że $x_1 \in X \Rightarrow x_2\in Y \Rightarrow x_2\in X \Rightarrow \dots \Rightarrow X_{2k}\in Y \Rightarrow x_{2k+1}\in X$. \\
$x_1,x_{2k+1}\in X$ sprzeczność z dwudzielnością $G$ 
\end{proof}
\begin{proof}$\Leftarrow$\\
$G$ nie zawiera nieparzystych cykli. Pokażemy że jest dwudzielny\\
$d(x,y)$ -- długość krawędzi najkrótszej $x-y$-drogi $(x,y \in V(G))$\\
Bez utraty ogólności możemy przyjąć, że $G$ jest spójny, gdyż składowe można rozpatrzyć osobno.\\
Niech
\begin{tabular}{l l}
	$u$ & będzie dowolnym wierzchołkiem\\
	$X$ & $\{ v\in V ~:~ ^2|d(u,v)\}$\\
	$Y$ & $\{ v\in V ~:~ ^2\nmid d(u,v)\}$
\end{tabular}
czyli $X\cap Y = \emptyset ~\wedge~ X\cup Y = V(G)$\\
Pokażemy, że $\forall e\in E(G) ~~ |e\cap X| = 1$\\
Przypuśćmy, że istnieje krawędź $e = xy$ taka  że $e\subset X$\footnote{analogicznie gdy $e\subset Y$}\\
$P$ -- najkrótsza $x-u$ droga\\
$Q$ -- najkrótsza $y-u$ droga\\
%TODO Dodać obrazek
Niech $v$ będzie wspólnym wierzchołkiem $P$ i $Q$ najbliżej $x$. Odcinki dróg $P$ i $Q$ z $u$ do $v$ są takiej samej długości bo w przeciwnym przypadku jedna z nich nie była by najkrótsza. Drogi $P$ i $Q$ mają tę samą parzystość, zatem odcinki dróg $P_x, Q_y$ z $v$ do $x$ i $y$ odpowiednio mają tę samą parzystość i długość. \\Zatem cykl $xP_xvQ_yyx$ jest nieparzystej długości.
\end{proof}
\end{tw}

\begin{df}
Skojarzenie to graf którego każda składowa ma jedną krawędź.
\end{df}
\begin{df}
$G$-graf, $M$-podgraf $G$ nazywamy skojarzeniem doskonałym jeżeli jest skojarzeniem i $V(M)=V(G)$\\
Takie skojarzenie nie zawsze istnieje
\end{df}
\begin{df}
Skojarzenie $M$ nazywamy 
\begin{enumerate}
	\item maksymalnym -- jeśli nie jest zawarte w skojarzeniu o większej liczbie krawędzi
	\item maksymalnej liczności -- jeśli nie istnieje skojarzenie o większej liczbie krawędzi
\end{enumerate}
\end{df}

\end{document}

